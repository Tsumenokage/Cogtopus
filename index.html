<!doctype html>
<html lang="fr">
	<head>
	  	<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Cogtopus</title>
    	<link href="css/bootstrap.min.css" rel="stylesheet">
    	<link href="css/style.css" rel="stylesheet">
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	    <script src="js/bootstrap.min.js"></script>
		<!--script src="masters/header.js"></script-->
		<!-- maps --> 
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8NKmCuIVrno_ISygSrp__Y8EFoFij-GY" type="text/javascript"></script>
		<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
		<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
		
	</head>
	<body>
		
		<nav class="navbar navbar-default">
			<div class="container-fluid">
				<!-- Brand and toggle get grouped for better mobile display FIXE-->
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#">LOGO</a>
					<h1 class="navbar-text">Alerte évènement à LIEU. Veuillez rester chez vous.</h1>
				</div>
				
				
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="nav navbar-nav">
						<li></li>
					</ul>
					
					<ul class="nav navbar-nav navbar-left">
						<li><a href="#">Protocoles à suivre</a></li>
						<li><a href="#">Toutes les informations</a></li>
						<li><a href="#">Les secours les plus proches</a></li>     
					</ul>
					
				</div><!-- /.navbar-collapse -->	
			</div><!-- /.container-fluid -->
		</nav>
		<div id="wrapper">
			<div id="grosseBoite"> 
				
				<div class="container-fluid">
					<div class="row" >
						<div class="col-lg-1 col-md-1 box" id="infos_offi">Informations officielles</div>
						<div class="col-lg-1 col-md-2 box" id="description_evenement">Description de l'évènement</div>
						
					</div>		
					
					<div class="row" >			
						<div class="col-lg-1 col-md-3 box" id="timeline_accueil">Timeline : les dernières informations</div>
						<div class="col-lg-1 col-md-4 box" id="maps">MAPS
							<div class="col-lg-1 col-md-5 aside" id="tweets">Les plus retweetés</div>				
						</div>
					</div>
					
					<div class="row" >
						<div class="col-lg-1 col-md-5 box" id="protocoles">Protocoles à suivre en cas d'urgence</div>
					</div>
					
				</div>	
				
			</div>
			
			<div id="googleMap" style="width:45%;height:500px;"></div>
			<div id="zoneIcones">
				<img src="Ressources/icon_attentat.png" onclick="selectionIcone('icon_attentat');" style="width: 60px; height:94px;">
				<img src="Ressources/icon_epidemie.png" onclick="selectionIcone('icon_epidemie');" style="width: 60px; height:94px;">
				<img src="Ressources/icon_guerre.png" onclick="selectionIcone('icon_guerre');" style="width: 60px; height:94px;">
				<img src="Ressources/icon_incendie.png" onclick="selectionIcone('icon_incendie');" style="width: 60px; height:94px;">
				<img src="Ressources/icon_innondation.png" onclick="selectionIcone('icon_innondation');" style="width: 60px; height:94px;">
				<img src="Ressources/icon_seisme.png" onclick="selectionIcone('icon_seisme');" style="width: 60px; height:94px;">
			</div>
			
			
			
		</div>
		
		
		
		
		
		
		
		
	</body>
</html>		


<script>
	
    var browserSupportFlag =  new Boolean();
    var lat = 0;
    var lng = 0;
    var map = null;
    var myCenter=new google.maps.LatLng(44.80627089999999,-0.5974830999999767);
    var newInfo = null;
    var htmlVar =
	'<div id="signalEvent">' +
	' <label>Si vous ne connaissez pas la réponse, passez à la suite</label><br/><br/>' +
	' <label>Nombre de bless&eacute;s :</label> ' +
	' <input value="0"></input><br/><br/>' +
	' <label>Incident : </label>' +
	' <label for="enCours"><input id="enCours" type="radio" name="indicent" value="enCours" checked="true"/>En cours</label>' +
	' <label for="termine"><input id="termine" type="radio" name="indicent" value="termine" checked="false"/>Termin&eacute;</label><br/><br/>' +
	' <label>Zone de l\'incident : </label>' +
	' <label for="securise"><input id="securise" type="radio" name="secur" value="securise" checked="true"/>S&eacute;curis&eacute;</label>' +
	' <label for="nonSecurise"><input id="nonSecurise" type="radio" name="secur" value="nonSecurise" checked="false"/>Non s&eacute;curis&eacute;</label><br/><br/>' +
	' <button type="button" onclick="addMarker();">Prendre une photo de l\'incident</button><br/><br/>' +
	' <button type="button" onclick="addMarker();">Signaler l\'incident</button>' +
	'</div>';
    var markers = new Array();
    var icone = 'Ressources/icon_attentat.png';
	
    function initialize()
    {
        var mapProp = {
            center:new google.maps.LatLng(lat, lng),
            zoom:8,
            mapTypeId:google.maps.MapTypeId.ROADMAP
		};
		
        map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
		
        map.addListener('click', function(event) {
            var latlng = event.latLng;
            lat = latlng.lat();
            lng = latlng.lng();
			
            clickMap();
		});
        
        var infoWindow = new google.maps.InfoWindow({map: map});
		
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var pos = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
				};
				
                infoWindow.setPosition(pos);
                infoWindow.setContent('Location found.');
                map.setCenter(pos);
				}, function() {
                handleLocationError(true, infoWindow, map.getCenter());
			});
			} else {
            // Browser doesn't support Geolocation
            handleLocationError(false, infoWindow, map.getCenter());
		}
        
        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
			pos = {
				lat: 44.80627089999999,
				lng: -0.5974830999999767
			}
			infoWindow.setPosition(pos);
			infoWindow.setContent(browserHasGeolocation ?
			'Error: The Geolocation service failed.' :
			'Error: Your browser doesn\'t support geolocation.');
		}
	}
	
    google.maps.event.addDomListener(window, 'load', initialize);
	
    function clickMap()
    {
        if (newInfo != null)
		newInfo.close();
        newInfo = new google.maps.InfoWindow({
            'content' : htmlVar, 							// contenu qui sera affiché
            'map' : map,                                           // carte sur laquelle est affichée l'InfoWindow
            'position' : new google.maps.LatLng(lat, lng)       // position d'affichage de l'InfoWindow
		});
	}
	
    function addMarker()
    {
        var marker=new google.maps.Marker({
            position: new google.maps.LatLng(lat, lng),
            icon: icone
		});
		
        markers.push(marker);
        marker.setMap(map);
        newInfo.close();
	}
    
    function selectionIcone(img)
    {
		icone = "Ressources/" + img + ".png";
	}
    
    $.getJSON( "PHP/MarqeurData.php", function( data ) {
		var items = [];
		$.each( data, function( key, val ) {
			items.push( "<li id='" + key + "'>" + val + "</li>" );
		});
		
		$( "ul", {
			"class": "my-new-list",
			html: items.join( "" )
		}).appendTo( "body" );
	});
</script>